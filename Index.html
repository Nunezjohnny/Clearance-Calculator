<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Clearance - Budget Calculator</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState } = React;
    const { DollarSign, TrendingUp, Zap, AlertCircle, ChevronRight, RotateCcw, CheckCircle, ChevronDown, ChevronUp } = lucide;

    function ClearanceCalculator() {
      const [step, setStep] = useState(1);
      const [showAdvanced, setShowAdvanced] = useState(false);
      
      const [income, setIncome] = useState('');
      const [payFrequency, setPayFrequency] = useState('monthly');
      
      const [rent, setRent] = useState('');
      const [utilities, setUtilities] = useState('');
      const [debt, setDebt] = useState('');
      const [groceries, setGroceries] = useState('');
      const [gas, setGas] = useState('');
      const [subscriptions, setSubscriptions] = useState('');
      
      // Advanced fields
      const [insurance, setInsurance] = useState('');
      const [otherFixed, setOtherFixed] = useState('');
      const [eatingOut, setEatingOut] = useState('');
      const [shopping, setShopping] = useState('');
      const [entertainment, setEntertainment] = useState('');
      const [otherVariable, setOtherVariable] = useState('');
      
      const [newSubscriptions, setNewSubscriptions] = useState(null);
      const [newEatingOut, setNewEatingOut] = useState(null);
      const [newShopping, setNewShopping] = useState(null);
      const [newGas, setNewGas] = useState(null);
      const [newEntertainment, setNewEntertainment] = useState(null);
      const [avoidFees, setAvoidFees] = useState(0);
      const [negotiateBills, setNegotiateBills] = useState(0);
      const [sideIncome, setSideIncome] = useState(0);
      
      const [commitments, setCommitments] = useState([]);

      const fmt = (n) => new Intl.NumberFormat('en-US', { maximumFractionDigits: 0 }).format(n);

      const getMonthlyIncome = () => {
        const amount = parseFloat(income) || 0;
        if (payFrequency === 'biweekly') return amount * 26 / 12;
        if (payFrequency === 'twice-monthly') return amount * 2;
        return amount;
      };

      const monthlyIncome = getMonthlyIncome();
      
      const totalFixed = 
        (parseFloat(rent) || 0) +
        (parseFloat(utilities) || 0) +
        (parseFloat(debt) || 0) +
        (parseFloat(insurance) || 0) +
        (parseFloat(otherFixed) || 0);
      
      const currentGas = parseFloat(gas) || 0;
      const currentGroceries = parseFloat(groceries) || 0;
      const currentSubscriptions = parseFloat(subscriptions) || 0;
      const currentEatingOut = parseFloat(eatingOut) || 0;
      const currentShopping = parseFloat(shopping) || 0;
      const currentEntertainment = parseFloat(entertainment) || 0;
      const currentOtherVariable = parseFloat(otherVariable) || 0;
      
      const totalVariable = currentGas + currentGroceries + currentSubscriptions + 
        currentEatingOut + currentShopping + currentEntertainment + currentOtherVariable;
      
      const baselineClearance = monthlyIncome - totalFixed - totalVariable;
      
      const activeLevers = [
        newSubscriptions !== null && newSubscriptions < currentSubscriptions,
        newEatingOut !== null && newEatingOut < currentEatingOut,
        newShopping !== null && newShopping < currentShopping,
        newGas !== null && newGas < currentGas,
        newEntertainment !== null && newEntertainment < currentEntertainment,
        avoidFees > 0,
        negotiateBills > 0,
        sideIncome > 0
      ].filter(Boolean).length;
      
      const subsSavings = newSubscriptions !== null ? (currentSubscriptions - newSubscriptions) : 0;
      const eatingOutSavings = newEatingOut !== null ? (currentEatingOut - newEatingOut) : 0;
      const shoppingSavings = newShopping !== null ? (currentShopping - newShopping) : 0;
      const gasSavings = newGas !== null ? (currentGas - newGas) : 0;
      const entertainmentSavings = newEntertainment !== null ? (currentEntertainment - newEntertainment) : 0;
      
      const totalSavings = subsSavings + eatingOutSavings + shoppingSavings + 
        gasSavings + entertainmentSavings + avoidFees + negotiateBills;
      
      const newClearance = baselineClearance + totalSavings + sideIncome;
      const improvement = newClearance - baselineClearance;

      const hasCompleteInputs = monthlyIncome > 0 && (totalFixed > 0 || totalVariable > 0);

      const fillAverage = (setter, avg) => {
        setter(avg.toString());
      };

      const resetLevers = () => {
        setNewSubscriptions(null);
        setNewEatingOut(null);
        setNewShopping(null);
        setNewGas(null);
        setNewEntertainment(null);
        setAvoidFees(0);
        setNegotiateBills(0);
        setSideIncome(0);
        setCommitments([]);
      };

      const toggleCommitment = (leverName) => {
        if (commitments.includes(leverName)) {
          setCommitments(commitments.filter(c => c !== leverName));
        } else {
          setCommitments([...commitments, leverName]);
        }
      };

      if (step === 1) {
        return (
          <div className="min-h-screen bg-gradient-to-br from-purple-600 to-purple-800 p-4 md:p-8">
            <div className="max-w-4xl mx-auto">
              <div className="text-center mb-8 text-white">
                <h1 className="text-5xl font-bold mb-2 drop-shadow-lg">
                  Clearance
                </h1>
                <p className="text-xl opacity-95 font-medium">
                  Let's see where you are right now
                </p>
              </div>

              <div className="bg-white rounded-2xl p-6 md:p-8 shadow-2xl">
                <div className="mb-8">
                  <h2 className="text-xl font-bold mb-2 text-gray-900 flex items-center gap-2">
                    <DollarSign size={24} className="text-purple-600" />
                    Take-Home Pay
                  </h2>
                  <p className="text-sm text-gray-600 mb-4">
                    After taxes‚Äîwhat actually hits your account
                  </p>
                  
                  <div className="flex gap-4 mb-4 flex-wrap">
                    <div className="flex-1 min-w-[200px]">
                      <InputField 
                        label={payFrequency === 'monthly' ? 'Monthly Pay' : payFrequency === 'biweekly' ? 'Per Paycheck (every 2 weeks)' : 'Per Paycheck (twice a month)'} 
                        value={income} 
                        onChange={setIncome} 
                      />
                    </div>
                    <div className="min-w-[200px]">
                      <label className="block text-sm font-semibold text-gray-700 mb-1">
                        Pay Frequency
                      </label>
                      <select
                        value={payFrequency}
                        onChange={(e) => setPayFrequency(e.target.value)}
                        className="w-full p-2.5 border-2 border-gray-300 rounded-lg text-base outline-none bg-white"
                      >
                        <option value="monthly">Monthly</option>
                        <option value="biweekly">Biweekly (every 2 weeks)</option>
                        <option value="twice-monthly">Twice a month</option>
                      </select>
                    </div>
                  </div>
                  
                  {payFrequency !== 'monthly' && monthlyIncome > 0 && (
                    <div className="text-sm text-purple-600 bg-purple-50 p-3 rounded-lg">
                      ‚âà ${fmt(monthlyIncome)}/month
                    </div>
                  )}
                </div>

                <div className="mb-8 pt-8 border-t-2 border-gray-200">
                  <h2 className="text-xl font-bold mb-2 text-gray-900">
                    Essential Monthly Bills
                  </h2>
                  <p className="text-sm text-gray-600 mb-4">
                    Use monthly estimates. If you're not sure, use Avg.
                  </p>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <InputField label="Rent/Mortgage" value={rent} onChange={setRent} />
                    <InputField label="Utilities" value={utilities} onChange={setUtilities} />
                    <InputField label="Debt Minimums" value={debt} onChange={setDebt} />
                    <InputFieldWithAvg label="Groceries" value={groceries} onChange={setGroceries} avg={400} onUseAvg={fillAverage} />
                    <InputFieldWithAvg label="Gas/Transportation" value={gas} onChange={setGas} avg={150} onUseAvg={fillAverage} />
                    <InputFieldWithAvg label="Subscriptions (Optional)" value={subscriptions} onChange={setSubscriptions} avg={50} onUseAvg={fillAverage} />
                  </div>
                </div>

                <div className="mb-8 pt-8 border-t-2 border-gray-200">
                  <button
                    onClick={() => setShowAdvanced(!showAdvanced)}
                    className="w-full flex items-center justify-between text-left mb-4 p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors"
                  >
                    <span className="text-lg font-bold text-gray-900">
                      Advanced (Optional)
                    </span>
                    {showAdvanced ? <ChevronUp size={20} /> : <ChevronDown size={20} />}
                  </button>
                  
                  {showAdvanced && (
                    <>
                      <p className="text-sm text-gray-600 mb-4">
                        Add these if they apply to you. Use monthly estimates.
                      </p>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <InputField label="Insurance" value={insurance} onChange={setInsurance} />
                        <InputField label="Other Fixed Bills" value={otherFixed} onChange={setOtherFixed} />
                        <InputFieldWithAvg label="Eating Out/Delivery" value={eatingOut} onChange={setEatingOut} avg={250} onUseAvg={fillAverage} />
                        <InputFieldWithAvg label="Shopping/Clothes" value={shopping} onChange={setShopping} avg={100} onUseAvg={fillAverage} />
                        <InputFieldWithAvg label="Entertainment" value={entertainment} onChange={setEntertainment} avg={80} onUseAvg={fillAverage} />
                        <InputField label="Other Spending" value={otherVariable} onChange={setOtherVariable} />
                      </div>
                    </>
                  )}
                </div>

                {hasCompleteInputs && (
                  <div className={`rounded-xl p-8 mb-6 text-white text-center ${
                    baselineClearance >= 0 
                      ? 'bg-gradient-to-br from-purple-600 to-purple-800'
                      : 'bg-gradient-to-br from-pink-500 to-red-500'
                  }`}>
                    <div className="text-sm uppercase tracking-wider opacity-90 font-semibold mb-2">
                      {baselineClearance >= 0 ? 'Safe-to-Spend (This Month)' : "You're Short By"}
                    </div>
                    <div className="text-6xl font-bold mb-2">
                      ${fmt(Math.abs(baselineClearance))}
                    </div>
                    <div className="text-base opacity-90 mb-4">
                      {baselineClearance >= 0 
                        ? "Money left after all your current spending"
                        : "More going out than coming in"}
                    </div>
                    <div className="text-sm opacity-80 bg-white bg-opacity-15 p-3 rounded-lg">
                      Income: ${fmt(monthlyIncome)} ‚àí Fixed: ${fmt(totalFixed)} ‚àí Variable: ${fmt(totalVariable)}
                    </div>
                  </div>
                )}

                <button
                  onClick={() => setStep(2)}
                  disabled={!hasCompleteInputs}
                  className={`w-full p-4 rounded-xl text-lg font-bold flex items-center justify-center gap-2 transition-all ${
                    hasCompleteInputs 
                      ? 'bg-gradient-to-br from-purple-600 to-purple-800 text-white hover:shadow-lg hover:-translate-y-0.5 cursor-pointer' 
                      : 'bg-gray-200 text-gray-400 cursor-not-allowed'
                  }`}
                >
                  Find Breathing Room
                  <ChevronRight size={24} />
                </button>
              </div>
            </div>
          </div>
        );
      }

      return (
        <div className="min-h-screen bg-gradient-to-br from-purple-600 to-purple-800 p-4 md:p-8">
          <div className="max-w-4xl mx-auto">
            <div className="text-center mb-8 text-white">
              <h1 className="text-5xl font-bold mb-2 drop-shadow-lg">
                Clearance
              </h1>
              <p className="text-xl opacity-95 font-medium">
                Try 1‚Äì2 changes to create breathing room
              </p>
            </div>

            <div className="bg-white rounded-2xl p-6 md:p-8 shadow-2xl mb-6">
              <div className={`rounded-xl p-8 mb-8 text-white text-center ${
                baselineClearance >= 0 
                  ? 'bg-gradient-to-br from-purple-600 to-purple-800'
                  : 'bg-gradient-to-br from-pink-500 to-red-500'
              }`}>
                <div className="text-sm uppercase tracking-wider opacity-90 font-semibold mb-2">
                  {baselineClearance >= 0 ? 'Current Safe-to-Spend' : "Currently Short By"}
                </div>
                <div className="text-6xl font-bold mb-2">
                  ${fmt(Math.abs(baselineClearance))}
                </div>
              </div>

              <div className="mb-8">
                <div className="flex justify-between items-center mb-2">
                  <h2 className="text-xl font-bold text-gray-900 flex items-center gap-2 m-0">
                    <Zap size={24} className="text-yellow-500" />
                    What-If Levers
                  </h2>
                  {activeLevers > 0 && (
                    <button
                      onClick={resetLevers}
                      className="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-semibold text-purple-600 flex items-center gap-1"
                    >
                      <RotateCcw size={16} />
                      Reset
                    </button>
                  )}
                </div>
                <p className="text-sm text-gray-600 mb-2">
                  Pick 1‚Äì2 changes you'll actually try this week
                </p>
                {activeLevers > 2 && (
                  <div className="bg-yellow-100 border border-yellow-400 rounded-lg p-3 mb-4 text-sm text-yellow-900">
                    ‚ö†Ô∏è You picked {activeLevers} changes. Try focusing on just 1-2 for better results.
                  </div>
                )}

                <div className="flex flex-col gap-6 mt-4">
                  {currentSubscriptions > 0 && (
                    <ReductionSlider 
                      label="Subscriptions" 
                      emoji="üì±"
                      current={currentSubscriptions}
                      value={newSubscriptions !== null ? newSubscriptions : currentSubscriptions}
                      onChange={setNewSubscriptions}
                      isCommitted={commitments.includes('subscriptions')}
                      onToggleCommit={() => toggleCommitment('subscriptions')}
                      fmt={fmt}
                    />
                  )}
                  {currentGas > 0 && (
                    <ReductionSlider 
                      label="Gas/Transportation" 
                      emoji="üöó"
                      current={currentGas}
                      value={newGas !== null ? newGas : currentGas}
                      onChange={setNewGas}
                      isCommitted={commitments.includes('gas')}
                      onToggleCommit={() => toggleCommitment('gas')}
                      fmt={fmt}
                    />
                  )}
                  {currentEatingOut > 0 && (
                    <ReductionSlider 
                      label="Eating Out/Delivery" 
                      emoji="üçî"
                      current={currentEatingOut}
                      value={newEatingOut !== null ? newEatingOut : currentEatingOut}
                      onChange={setNewEatingOut}
                      isCommitted={commitments.includes('eatingOut')}
                      onToggleCommit={() => toggleCommitment('eatingOut')}
                      fmt={fmt}
                    />
                  )}
                  {currentShopping > 0 && (
                    <ReductionSlider 
                      label="Shopping/Clothes" 
                      emoji="üõçÔ∏è"
                      current={currentShopping}
                      value={newShopping !== null ? newShopping : currentShopping}
                      onChange={setNewShopping}
                      isCommitted={commitments.includes('shopping')}
                      onToggleCommit={() => toggleCommitment('shopping')}
                      fmt={fmt}
                    />
                  )}
                  {currentEntertainment > 0 && (
                    <ReductionSlider 
                      label="Entertainment" 
                      emoji="üéÆ"
                      current={currentEntertainment}
                      value={newEntertainment !== null ? newEntertainment : currentEntertainment}
                      onChange={setNewEntertainment}
                      isCommitted={commitments.includes('entertainment')}
                      onToggleCommit={() => toggleCommitment('entertainment')}
                      fmt={fmt}
                    />
                  )}
                  
                  <AdditionSlider 
                    label="Avoid Fees (overdraft, late payments)" 
                    emoji="üö´"
                    value={avoidFees}
                    onChange={setAvoidFees}
                    max={150}
                    step={5}
                    isCommitted={commitments.includes('fees')}
                    onToggleCommit={() => toggleCommitment('fees')}
                    fmt={fmt}
                  />
                  <AdditionSlider 
                    label="Negotiate Bills (phone, internet, insurance)" 
                    emoji="üìû"
                    value={negotiateBills}
                    onChange={setNegotiateBills}
                    max={100}
                    step={5}
                    isCommitted={commitments.includes('negotiate')}
                    onToggleCommit={() => toggleCommitment('negotiate')}
                    fmt={fmt}
                  />
                  <AdditionSlider 
                    label="Add Side Income" 
                    emoji="üí∞"
                    value={sideIncome}
                    onChange={setSideIncome}
                    max={1000}
                    step={25}
                    isCommitted={commitments.includes('income')}
                    onToggleCommit={() => toggleCommitment('income')}
                    fmt={fmt}
                  />
                </div>
              </div>

              {improvement > 0 && (
                <div className="bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-6 text-white mb-6">
                  <div className="flex items-center gap-3 mb-3">
                    <TrendingUp size={28} />
                    <div>
                      <div className="text-sm opacity-90">
                        New Safe-to-Spend
                      </div>
                      <div className="text-4xl font-bold">
                        ${fmt(newClearance)}
                      </div>
                    </div>
                  </div>
                  <div className="bg-white bg-opacity-20 rounded-lg p-4 text-base font-semibold">
                    üéØ You found <span className="text-xl">${fmt(improvement)}</span> of breathing room per month
                    <div className="text-sm mt-2 opacity-90">
                      That's ${fmt(improvement * 12)} per year
                    </div>
                  </div>
                  
                  {commitments.length > 0 && (
                    <div className="mt-4 bg-white bg-opacity-20 rounded-lg p-4">
                      <div className="text-sm mb-2 flex items-center gap-2">
                        <CheckCircle size={18} />
                        <strong>You committed to try:</strong>
                      </div>
                      <ul className="m-0 pl-6 text-sm">
                        {commitments.map(c => (
                          <li key={c} className="mb-1">
                            {c === 'subscriptions' && 'Cut subscriptions'}
                            {c === 'eatingOut' && 'Reduce eating out'}
                            {c === 'shopping' && 'Cut shopping'}
                            {c === 'gas' && 'Reduce transportation costs'}
                            {c === 'entertainment' && 'Cut entertainment'}
                            {c === 'fees' && 'Avoid fees'}
                            {c === 'negotiate' && 'Negotiate bills'}
                            {c === 'income' && 'Add side income'}
                          </li>
                        ))}
                      </ul>
                    </div>
                  )}
                </div>
              )}

              <button
                onClick={() => setStep(1)}
                className="w-full p-4 bg-white hover:bg-gray-50 text-purple-600 border-2 border-purple-600 rounded-xl text-base font-bold transition-all"
              >
                ‚Üê Back to Edit Numbers
              </button>
            </div>

            <div className="bg-white bg-opacity-15 backdrop-blur-lg rounded-lg p-4 text-white text-xs text-center flex items-center justify-center gap-2">
              <AlertCircle size={16} />
              <span>This is educational only, not financial advice. Consult a professional for personalized guidance.</span>
            </div>
          </div>
        </div>
      );
    }

    function InputField({ label, value, onChange }) {
      return (
        <div>
          <label className="block text-sm font-semibold text-gray-700 mb-1">
            {label}
          </label>
          <div className="relative">
            <span className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-medium">
              $
            </span>
            <input
              type="number"
              value={value}
              onChange={(e) => onChange(e.target.value)}
              className="w-full pl-7 pr-3 py-2.5 border-2 border-gray-300 rounded-lg text-base outline-none focus:border-purple-500 transition-colors"
              placeholder="0"
            />
          </div>
        </div>
      );
    }

    function InputFieldWithAvg({ label, value, onChange, avg, onUseAvg }) {
      return (
        <div>
          <label className="block text-sm font-semibold text-gray-700 mb-1">
            {label}
          </label>
          <div className="flex gap-2">
            <div className="relative flex-1">
              <span className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-medium">
                $
              </span>
              <input
                type="number"
                value={value}
                onChange={(e) => onChange(e.target.value)}
                className="w-full pl-7 pr-3 py-2.5 border-2 border-gray-300 rounded-lg text-base outline-none focus:border-purple-500 transition-colors"
                placeholder="0"
              />
            </div>
            <button
              onClick={() => onUseAvg(onChange, avg)}
              className="px-3 py-2.5 bg-purple-100 hover:bg-purple-200 text-purple-700 rounded-lg text-sm font-semibold transition-colors"
            >
              Avg
            </button>
          </div>
        </div>
      );
    }

    function ReductionSlider({ label, emoji, current, value, onChange, isCommitted, onToggleCommit, fmt }) {
      const savings = current - value;
      const percentReduction = current > 0 ? ((savings / current) * 100).toFixed(0) : 0;
      
      return (
        <div className="bg-gray-50 p-4 rounded-lg">
          <div className="flex justify-between items-start mb-3">
            <div className="flex items-center gap-2">
              <span className="text-2xl">{emoji}</span>
              <div>
                <div className="font-semibold text-gray-900">{label}</div>
                <div className="text-sm text-gray-600">Currently: ${fmt(current)}/mo</div>
              </div>
            </div>
            {savings > 0 && (
              <button
                onClick={onToggleCommit}
                className={`px-3 py-1.5 rounded-lg text-sm font-semibold transition-all ${
                  isCommitted 
                    ? 'bg-green-500 text-white' 
                    : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                }`}
              >
                {isCommitted ? '‚úì Committed' : 'Commit'}
              </button>
            )}
          </div>
          
          <input
            type="range"
            min="0"
            max={current}
            step="5"
            value={value}
            onChange={(e) => onChange(parseFloat(e.target.value))}
            className="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer accent-purple-600"
          />
          
          <div className="flex justify-between items-center mt-2">
            <div className="text-sm">
              <span className="font-semibold text-gray-900">New: ${fmt(value)}/mo</span>
            </div>
            {savings > 0 && (
              <div className="text-sm font-semibold text-green-600">
                Save ${fmt(savings)}/mo ({percentReduction}% less)
              </div>
            )}
          </div>
        </div>
      );
    }

    function AdditionSlider({ label, emoji, value, onChange, max, step, isCommitted, onToggleCommit, fmt }) {
      return (
        <div className="bg-gray-50 p-4 rounded-lg">
          <div className="flex justify-between items-start mb-3">
            <div className="flex items-center gap-2">
              <span className="text-2xl">{emoji}</span>
              <div>
                <div className="font-semibold text-gray-900">{label}</div>
              </div>
            </div>
            {value > 0 && (
              <button
                onClick={onToggleCommit}
                className={`px-3 py-1.5 rounded-lg text-sm font-semibold transition-all ${
                  isCommitted 
                    ? 'bg-green-500 text-white' 
                    : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                }`}
              >
                {isCommitted ? '‚úì Committed' : 'Commit'}
              </button>
            )}
          </div>
          
          <input
            type="range"
            min="0"
            max={max}
            step={step}
            value={value}
            onChange={(e) => onChange(parseFloat(e.target.value))}
            className="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer accent-purple-600"
          />
          
          <div className="flex justify-between items-center mt-2">
            <div className="text-sm">
              <span className="font-semibold text-gray-900">${fmt(value)}/mo</span>
            </div>
            {value > 0
&& (
<div className="text-sm font-semibold text-green-600">
+${fmt(value)}/mo extra
</div>
)}
</div>
</div>
);
}
ReactDOM.render(<ClearanceCalculator />, document.getElementById('root'));
  </script>
</body>
</html>
```
